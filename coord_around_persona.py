# -*- coding: utf-8 -*-
"""
Created on Fri Aug  3 14:42:18 2018

@author: wfsha
"""

import pandas as pd
from coordTransform_utils import bd09_to_wgs84

sh = pd.read_csv('E:/Desktop/0805/sh.csv')
sh.columns =  ['i','gender','age','ptype','is_core','lat','lon','gw']

gz = pd.read_csv('E:/Desktop/0805/gz.csv')
gz.columns =  ['i','gender','age','ptype','is_core','lat','lon','gw']

sz = pd.read_csv('E:/Desktop/0805/sz.csv')
sz.columns =  ['i','gender','age','ptype','is_core','lat','lon','gw']



#sh = sz

#上海
#ptype = 1 vs ptype = 2   ptype	位置驻留类型	INT	0-到访;1-居住;2-工作
1. 250米，750米，1250米居住人口
2. 250米，750米，1250米工作人口
3. 250米，750米，1250米职住比 vs 上海总体职住比

#250米辐射范围内
lall = [[191, 108],[151, 51],[119, 41]]#上海市三个指定位置的grid坐标，以下得出该坐标所在grid范围内的画像
#[[255, 281],[251, 271],[102, 381]]
df = pd.DataFrame(columns=['c1','c2'])
for lo in lall:
    #print(num)
    num += 1
    live = sum(sh[(sh.ptype == 1)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    work = sum(sh[(sh.ptype == 2)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    df.loc[num,'c1'] = live
    df.loc[num,'c2'] = work
    df.to_clipboard()
    print(live,work)


#750米辐射范围
lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    live = sum(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'])
    work = sum(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'])
    print(live,work)
#1250米辐射范围
lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
#[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    live = sum(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'])
    work = sum(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'])
    print(live,work)   

#ptype = 1, is_core = F vs. is_core = T######################################################################
#250
lall = [[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
#[[185, 271],[151, 51],[330, 131],[113, 99],[213, 204]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    N = sum(sh[(sh.ptype == 1)&(sh.is_core == 'N')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    Y = sum(sh[(sh.ptype == 1)&(sh.is_core == 'Y')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    print(N,Y)
    
#750
lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
#[[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    N = sum(sh[(sh.ptype == 1)&(sh.is_core == 'N')&(sh.mark == 1)]['gw'])
    Y = sum(sh[(sh.ptype == 1)&(sh.is_core == 'Y')&(sh.mark == 1)]['gw'])
    print(N,Y)
#1250
lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
#[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    N = sum(sh[(sh.ptype == 1)&(sh.is_core == 'N')&(sh.mark == 1)]['gw'])
    Y = sum(sh[(sh.ptype == 1)&(sh.is_core == 'Y')&(sh.mark == 1)]['gw'])
    print(N,Y)
    
    
#居住人口 男女  
#250
lall = [[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    M = sum(sh[(sh.ptype == 1)&(sh.gender == 'M')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.gender == 'F')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    print(M,F)
    
#750
lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
#[[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 1)&(sh.gender == 'M')&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.gender == 'F')&(sh.mark == 1)]['gw'])
    print(M,F)
#1250
lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]][[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 1)&(sh.gender == 'M')&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.gender == 'F')&(sh.mark == 1)]['gw'])
    print(M,F)
    
#工作人口男女
#250
lall = [[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    M = sum(sh[(sh.ptype == 2)&(sh.gender == 'M')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    F = sum(sh[(sh.ptype == 2)&(sh.gender == 'F')&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    print(M,F)
    
#750
lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
#[[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 2)&(sh.gender == 'M')&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 2)&(sh.gender == 'F')&(sh.mark == 1)]['gw'])
    print(M,F)
#1250
lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
#[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 2)&(sh.gender == 'M')&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 2)&(sh.gender == 'F')&(sh.mark == 1)]['gw'])
    print(M,F)    
    
#游玩人口
#居住人口+工作人口###################################

#250
lall = [[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    M = sum(sh[(sh.ptype == 0)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    F2 = sum(sh[(sh.ptype == 2)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'])
    print(M,F+F2)
    
#750
lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
#[[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 0)&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'])
    F2 = sum(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'])
    print(M,F+F2)
#1250
lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
#[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    M = sum(sh[(sh.ptype == 0)&(sh.mark == 1)]['gw'])
    F = sum(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'])
    F2 = sum(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'])
    print(M,F+F2)    
-------------------------------------------------------------xiuggai    
1. 居住人口年龄分布
2. 居住人口上海年龄分布    
    
    sh[sh.ptype == 1]['i'].groupby(sh.age).count()
    

#250
lall =[[185, 271],[151, 51],[330, 131],[113, 99],[213, 204]]
#[[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    print(sh[(sh.ptype == 1)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'].groupby(sh.age).sum())

    
#750
#lall = [[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
lall =[[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    print(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'].groupby(sh.age).sum())
#1250
#lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
lall =[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    print(sh[(sh.ptype == 1)&(sh.mark == 1)]['gw'].groupby(sh.age).sum())     


#1. 工作人口年龄分布
#2. 工作人口上海年龄分布    
#250
lall = [[185, 271],[151, 51],[330, 131],[113, 99],[213, 204]]
#[[191, 108],[151, 51],[119, 41]]
#[[255, 281],[251, 271],[102, 381]]
num = 1
for lo in lall:
    #print(num)
    num += 1
    print(sh[(sh.ptype == 2)&(sh.lon == lo[0])&(sh.lat == lo[1])]['gw'].groupby(sh.age).sum())

    
#750
lall = 
#[[[190, 107],[190, 108],[190, 109],[191, 107],[191, 108],[191, 109],[192, 107],[192, 108],[192, 109]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[118, 40],[118, 41],[118, 42],[119, 40],[119, 41],[119, 42],[120, 40],[120, 41],[120, 42]]]
#[[[254, 280], [254, 281], [254, 282], [255, 280], [255, 281], [255, 282], [256, 280], [256,281], [256, 282]],[[250, 270], [250, 271], [250, 272], [251, 270], [251, 271], [251, 272], [252, 270], [252, 271], [252, 272]],[[101, 380], [101, 381], [101, 382], [102, 380], [102, 381], [102, 382], [103, 380], [103, 381], [103, 382]]]
lall = [[[184, 270],[184, 271],[184, 272],[185, 270],[185, 271],[185, 272],[186, 270],[186, 271],[186, 272]],[[150, 50],[150, 51],[150, 52],[151, 50],[151, 51],[151, 52],[152, 50],[152, 51],[152, 52]],[[329, 130],[329, 131],[329, 132],[330, 130],[330, 131],[330, 132],[331, 130],[331, 131],[331, 132]],[[112, 98],[112, 99],[112, 100],[113, 98],[113, 99],[113, 100],[114, 98],[114, 99],[114, 100]],[[212, 203],[212, 204],[212, 205],[213, 203],[213, 204],[213, 205],[214, 203],[214, 204],[214, 205]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    print(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'].groupby(sh.age).sum())
#1250
#lall = [[[189, 106],[189, 107],[189, 108],[189, 109],[189, 110],[190, 106],[190, 107],[190, 108],[190, 109],[190, 110],[191, 106],[191, 107],[191, 108],[191, 109],[191, 110],[192, 106],[192, 107],[192, 108],[192, 109],[192, 110],[193, 106],[193, 107],[193, 108],[193, 109],[193, 110]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[117, 39],[117, 40],[117, 41],[117, 42],[117, 43],[118, 39],[118, 40],[118, 41],[118, 42],[118, 43],[119, 39],[119, 40],[119, 41],[119, 42],[119, 43],[120, 39],[120, 40],[120, 41],[120, 42],[120, 43],[121, 39],[121, 40],[121, 41],[121, 42],[121, 43]]]
#[[[253, 279],[253, 280],[253, 281],[253, 282],[253, 283],[254, 279],[254, 280],[254, 281],[254, 282],[254, 283],[255, 279],[255, 280],[255, 281],[255, 282],[255, 283],[256, 279],[256, 280],[256, 281],[256, 282],[256, 283],[257, 279],[257, 280],[257, 281],[257, 282],[257, 283]],[[249, 269],[249, 270],[249, 271],[249, 272],[249, 273],[250, 269],[250, 270],[250, 271],[250, 272],[250, 273],[251, 269],[251, 270],[251, 271],[251, 272],[251, 273],[252, 269],[252, 270],[252, 271],[252, 272],[252, 273],[253, 269],[253, 270],[253, 271],[253, 272],[253, 273]],[[100, 379],[100, 380],[100, 381],[100, 382],[100, 383],[101, 379],[101, 380],[101, 381],[101, 382],[101, 383],[102, 379],[102, 380],[102, 381],[102, 382],[102, 383],[103, 379],[103, 380],[103, 381],[103, 382],[103, 383],[104, 379],[104, 380],[104, 381],[104, 382],[104, 383]]]
lall =[[[183, 269],[183, 270],[183, 271],[183, 272],[183, 273],[184, 269],[184, 270],[184, 271],[184, 272],[184, 273],[185, 269],[185, 270],[185, 271],[185, 272],[185, 273],[186, 269],[186, 270],[186, 271],[186, 272],[186, 273],[187, 269],[187, 270],[187, 271],[187, 272],[187, 273]],[[149, 49],[149, 50],[149, 51],[149, 52],[149, 53],[150, 49],[150, 50],[150, 51],[150, 52],[150, 53],[151, 49],[151, 50],[151, 51],[151, 52],[151, 53],[152, 49],[152, 50],[152, 51],[152, 52],[152, 53],[153, 49],[153, 50],[153, 51],[153, 52],[153, 53]],[[328, 129],[328, 130],[328, 131],[328, 132],[328, 133],[329, 129],[329, 130],[329, 131],[329, 132],[329, 133],[330, 129],[330, 130],[330, 131],[330, 132],[330, 133],[331, 129],[331, 130],[331, 131],[331, 132],[331, 133],[332, 129],[332, 130],[332, 131],[332, 132],[332, 133]],[[111, 97],[111, 98],[111, 99],[111, 100],[111, 101],[112, 97],[112, 98],[112, 99],[112, 100],[112, 101],[113, 97],[113, 98],[113, 99],[113, 100],[113, 101],[114, 97],[114, 98],[114, 99],[114, 100],[114, 101],[115, 97],[115, 98],[115, 99],[115, 100],[115, 101]],[[211, 202],[211, 203],[211, 204],[211, 205],[211, 206],[212, 202],[212, 203],[212, 204],[212, 205],[212, 206],[213, 202],[213, 203],[213, 204],[213, 205],[213, 206],[214, 202],[214, 203],[214, 204],[214, 205],[214, 206],[215, 202],[215, 203],[215, 204],[215, 205],[215, 206]]]
num = 1
for l in lall:
    #print(num)
    num += 1
    sh['mark'] = 0
    for lo in l:
        sh.loc[(sh.lon == lo[0])&(sh.lat == lo[1]),'mark'] = 1
    print(sh[(sh.ptype == 2)&(sh.mark == 1)]['gw'].groupby(sh.age).sum())  



























    
    



def foo(lon,lat):
    s = []
    lon = lon - 2
    lat = lat - 2
    for i in range(0,5):
        for j in range(0,5):
            s.append([lon+i,lat+j])           
    return s

def wgs_to_grid(lon,lat):
    slon = 112.95850716
    slat = 22.51436103
    mlon = 0.00242610105286935
    mlat = 0.00226617728902972
    lon1 = int((lon-slon)/mlon)
    lat1 = int((lat-slat)/mlat)    
    return [lon1,lat1]

g1['center'] = '广州市增城区新塘镇凤凰城凤锦苑天麓街9号'
g2['center'] = '广州市增城市新塘镇凤凰城凤凰广场步行街南二号之八'
g3['center'] = '广州市花都区商业大道35号'

g1 = [113.5896980000,23.1547220000]
g1 = bd09_to_wgs84(g1[0],g1[1])
g1 = wgs_to_grid(g1[0],g1[1])
g11 = foo(g1[0],g1[1])

g2 = [113.5807570000,23.1315810000]
g2 = bd09_to_wgs84(g2[0],g2[1])
g2 = wgs_to_grid(g2[0],g2[1])
g22 = foo(g2[0],g2[1])

g3 = [113.2179970000,23.3823500000]
g3 = bd09_to_wgs84(g3[0],g3[1])
g3 = wgs_to_grid(g3[0],g3[1])
g33 = foo(g3[0],g3[1])

gall = g11+g22+g33

lon = []
lat = []
for i in gall:
    lon.append(i[0])
    lat.append(i[1])
    
    
with open('E:/Desktop/gtemp.txt','w') as f:
    f.write('lon:')
    f.write(str(lon))
    f.write('lat:')
    f.write(str(lat))




#==============================================

def wgs_to_grid(lon,lat):
    slon = 113.75145396
    slat = 22.43858103
    mlon = 0.00244293292296181
    mlat = 0.00220399452847563
    lon1 = int((lon-slon)/mlon)
    lat1 = int((lat-slat)/mlat) 
    return [lon1,lat1]


s1 = [114.2308000000,22.6821800000]
s1 = bd09_to_wgs84(s1[0],s1[1])
s1 = wgs_to_grid(s1[0],s1[1])
s11 = foo(s1[0],s1[1])

s2 = [114.1330560000,22.5559030000]
s2 = bd09_to_wgs84(s2[0],s2[1])
s2 = wgs_to_grid(s2[0],s2[1])
s22 = foo(s2[0],s2[1])

s3 = [114.0556450000,22.5329520000]
s3 = bd09_to_wgs84(s3[0],s3[1])
s3 = wgs_to_grid(s3[0],s3[1])
s33 = foo(s3[0],s3[1])
sall = s11+s22+s33






sa1 = sz[(sz['lat'] == s1[1])&(sz['lon'] == s1[0])]
sa2 = sz[(sz['lat'] == s2[1])&(sz['lon'] == s2[0])]
sa3 = sz[(sz['lat'] == s3[1])&(sz['lon'] == s3[0])]


sa1['center'] = '深圳市龙岗区荷坳乐城S-52-5'
sa2['center'] = '深圳市罗湖区中兴路88号京基东方颐苑'
sa3['center'] = '深圳市福田区新洲南路3191号新洲花园'









g1250 = pd.read_csv('E:/Desktop/bgy/gz3spotchosen_km.csv',encoding = 'gb18030')
g1250['center'] = 0

for i in g11:
    g1250.loc[(g1250.lon == i[0])&(g1250.lat == i[1]),'center'] = '广州市增城区新塘镇凤凰城凤锦苑天麓街9号'

for i in g22:
    g1250.loc[(g1250.lon == i[0])&(g1250.lat == i[1]),'center'] = '广州市增城市新塘镇凤凰城凤凰广场步行街南二号之八'


for i in g33:
    g1250.loc[(g1250.lon == i[0])&(g1250.lat == i[1]),'center'] = '广州市花都区商业大道35号'
    
g1250.to_csv('E:/Desktop/bgy/gz3_1250x1250.csv',encoding = 'gb18030')

---

g250 = pd.read_csv('E:/Desktop/bgy/gz3spotchosen.csv',encoding = 'gb18030')
g250['center'] = 0

g250.loc[(g250.lon == g1[0])&(g250.lat == g1[1]),'center'] = '广州市增城区新塘镇凤凰城凤锦苑天麓街9号'

g250.loc[(g250.lon == g2[0])&(g250.lat == g2[1]),'center'] = '广州市增城市新塘镇凤凰城凤凰广场步行街南二号之八'


g250.loc[(g250.lon == g3[0])&(g250.lat == g3[1]),'center'] = '广州市花都区商业大道35号'
    
g250.to_csv('E:/Desktop/bgy/gz3_250x250.csv',encoding = 'gb18030')



######


s1250 = pd.read_csv('E:/Desktop/bgy/sz3spotchosen_km.csv',encoding = 'gb18030')
s1250['center'] = 0

for i in s11:
    s1250.loc[(s1250.lon == i[0])&(s1250.lat == i[1]),'center'] = '深圳市龙岗区荷坳乐城S-52-5'

for i in s22:
    s1250.loc[(s1250.lon == i[0])&(s1250.lat == i[1]),'center'] = '深圳市罗湖区中兴路88号京基东方颐苑'


for i in s33:
    s1250.loc[(s1250.lon == i[0])&(s1250.lat == i[1]),'center'] = '深圳市福田区新洲南路3191号新洲花园'
    
s1250.to_csv('E:/Desktop/bgy/sz3_1250x1250.csv',encoding = 'gb18030')


-----
s250 = pd.read_csv('E:/Desktop/bgy/sz3spotchosen_km.csv',encoding = 'gb18030')
s250['center'] = 0

s250.loc[(s250.lon == s1[0])&(s250.lat == s1[1]),'center'] = '深圳市龙岗区荷坳乐城S-52-5'

s250.loc[(s250.lon == s2[0])&(s250.lat == s2[1]),'center'] = '深圳市罗湖区中兴路88号京基东方颐苑'


s250.loc[(s250.lon == s3[0])&(s250.lat == s3[1]),'center'] = '深圳市福田区新洲南路3191号新洲花园'
    
s250.to_csv('E:/Desktop/bgy/sz3_250x250.csv',encoding = 'gb18030')





